cmake_minimum_required(VERSION 3.8)
project(tf2_demo)

if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES "Clang")
  add_compile_options(-Wall -Wextra -Wpedantic)
endif()

# ==============================
# ğŸ”‘ å…³é”®ä¿®æ­£ï¼šæ·»åŠ  tf2_geometry_msgs
# ==============================
find_package(ament_cmake REQUIRED)
find_package(rclcpp REQUIRED)
find_package(rclpy REQUIRED)             # è™½æœªç›´æ¥ç”¨äºC++ï¼Œä½†åŒ…ä¾èµ–ä¸­å£°æ˜äº†
find_package(tf2 REQUIRED)
find_package(tf2_ros REQUIRED)
find_package(tf2_msgs REQUIRED)          # å®é™…å¯çœç•¥ï¼ˆé™¤éç›´æ¥ç”¨TFMessageï¼‰
find_package(tf2_geometry_msgs REQUIRED) # âœ… å¿…é¡»æ·»åŠ ï¼ç”¨äº getYaw / doTransform
find_package(geometry_msgs REQUIRED)

# ==============================
# æµ‹è¯•é…ç½®ï¼ˆå¯é€‰ï¼‰
# ==============================
if(BUILD_TESTING)
  find_package(ament_lint_auto REQUIRED)
  # è·³è¿‡ç‰ˆæƒæ£€æŸ¥ï¼ˆå¼€å‘é˜¶æ®µå¯æ¥å—ï¼‰
  set(ament_cmake_copyright_FOUND TRUE)
  set(ament_cmake_cpplint_FOUND TRUE)
  ament_lint_auto_find_test_dependencies()
endif()

# ==============================
# å¯æ‰§è¡Œæ–‡ä»¶ï¼šC++ èŠ‚ç‚¹
# ==============================

# é™æ€ TF å¹¿æ’­å™¨
add_executable(static_tf_broadcaster src/static_tf_broadcaster.cpp)
ament_target_dependencies(static_tf_broadcaster
  rclcpp
  tf2_ros
  geometry_msgs
)
install(TARGETS static_tf_broadcaster
  DESTINATION lib/${PROJECT_NAME}
)

# TF ç›‘å¬å™¨ï¼ˆä½¿ç”¨ tf2_geometry_msgsï¼‰
add_executable(tf2_listener src/tf2_listener.cpp)
ament_target_dependencies(tf2_listener
  rclcpp
  tf2_ros
  tf2_geometry_msgs  # âœ… æ­£ç¡®é“¾æ¥
)
install(TARGETS tf2_listener
  DESTINATION lib/${PROJECT_NAME}
)

# ==============================
# Python è„šæœ¬ & é…ç½®æ–‡ä»¶
# ==============================

# åŠ¨æ€ TF å¹¿æ’­å™¨ï¼ˆPythonï¼‰
install(PROGRAMS src/dynamic_tf_broadcaster.py
  DESTINATION lib/${PROJECT_NAME}
)

# RViz é…ç½®æ–‡ä»¶
install(DIRECTORY rviz
  DESTINATION share/${PROJECT_NAME}/
)

# Launch æ–‡ä»¶
install(DIRECTORY launch
  DESTINATION share/${PROJECT_NAME}/
)

# ==============================
# æœ€ç»ˆå£°æ˜
# ==============================
ament_package()